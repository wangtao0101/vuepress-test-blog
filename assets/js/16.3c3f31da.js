(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{492:function(t,a,s){"use strict";s.r(a);var _=s(94),e=Object(_.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"json函数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#json函数"}},[t._v("#")]),t._v(" JSON函数")]),t._v(" "),a("p",[t._v("===========================")]),t._v(" "),a("h1",{attrs:{id:"介绍"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#介绍"}},[t._v("#")]),t._v(" 介绍")]),t._v(" "),a("p",[t._v("本文介绍JSON函数的基本语法及示例。")]),t._v(" "),a("h1",{attrs:{id:"函数示例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#函数示例"}},[t._v("#")]),t._v(" 函数示例")]),t._v(" "),a("p",[t._v("日志服务支持如下JSON函数。")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("在日志服务分析语句中，表示字符串的字符必须使用单引号（''）包裹，无符号包裹或被双引号（\"\"）包裹的字符表示字段名或列名。例如：'status'表示字符串status，status或\"status\"表示日志字段status。")])]),t._v(" "),a("li",[a("p",[t._v("如果日志字段的值为JSON类型且需要展开为多行，请使用unnest语法。更多信息，请参见"),a("RouterLink",{attrs:{to:"/sqlfun/t15177.html"}},[t._v("UNNEST子句")]),t._v("。")],1)]),t._v(" "),a("li",[a("p",[t._v("如果字符串被解析成JSON类型失败，则返回null。")])])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("函数名称")]),t._v(" "),a("th",[t._v("语法")]),t._v(" "),a("th",[t._v("说明")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[a("a",{attrs:{href:"#json_array_contains%E5%87%BD%E6%95%B0"}},[t._v("json_array_contains函数")])]),t._v(" "),a("td",[t._v("json_array_contains( "),a("em",[t._v("x")]),t._v(" , "),a("em",[t._v("value")]),t._v(" )")]),t._v(" "),a("td",[t._v("判断JSON数组中是否包含某个值。")])]),t._v(" "),a("tr",[a("td",[a("a",{attrs:{href:"#json_array_get%E5%87%BD%E6%95%B0"}},[t._v("json_array_get函数")])]),t._v(" "),a("td",[t._v("json_array_get( "),a("em",[t._v("x")]),t._v(" , "),a("em",[t._v("index")]),t._v(" )")]),t._v(" "),a("td",[t._v("获取JSON数组中某个下标对应的元素。")])]),t._v(" "),a("tr",[a("td",[a("a",{attrs:{href:"#json_array_length%E5%87%BD%E6%95%B0"}},[t._v("json_array_length函数")])]),t._v(" "),a("td",[t._v("json_array_length( "),a("em",[t._v("x")]),t._v(" )")]),t._v(" "),a("td",[t._v("计算JSON数组中元素的数量。")])]),t._v(" "),a("tr",[a("td",[a("a",{attrs:{href:"#json_extract%E5%87%BD%E6%95%B0"}},[t._v("json_extract函数")])]),t._v(" "),a("td",[t._v("json_extract( "),a("em",[t._v("x")]),t._v(" , json_path)")]),t._v(" "),a("td",[t._v("从JSON对象或JSON数组中提取一组JSON值（数组或对象）。")])]),t._v(" "),a("tr",[a("td",[a("a",{attrs:{href:"#json_extract_scalar%E5%87%BD%E6%95%B0"}},[t._v("json_extract_scalar函数")])]),t._v(" "),a("td",[t._v("json_extract_scalar( "),a("em",[t._v("x")]),t._v(" , "),a("em",[t._v("json_path")]),t._v(" )")]),t._v(" "),a("td",[t._v("从JSON对象或JSON数组中提取一组标量值（字符串、整数或布尔值）。类似于json_extract函数。")])]),t._v(" "),a("tr",[a("td",[a("a",{attrs:{href:"#json_format%E5%87%BD%E6%95%B0"}},[t._v("json_format函数")])]),t._v(" "),a("td",[t._v("json_format( "),a("em",[t._v("x")]),t._v(" )")]),t._v(" "),a("td",[t._v("把JSON类型转化成字符串类型。")])]),t._v(" "),a("tr",[a("td",[a("a",{attrs:{href:"#json_parse%E5%87%BD%E6%95%B0"}},[t._v("json_parse函数")])]),t._v(" "),a("td",[t._v("json_parse( "),a("em",[t._v("x")]),t._v(" )")]),t._v(" "),a("td",[t._v("把字符串类型转化成JSON类型。")])]),t._v(" "),a("tr",[a("td",[a("a",{attrs:{href:"#json_size%E5%87%BD%E6%95%B0"}},[t._v("json_size函数")])]),t._v(" "),a("td",[t._v("json_size( "),a("em",[t._v("x")]),t._v(" , "),a("em",[t._v("json_path")]),t._v(" )")]),t._v(" "),a("td",[t._v("计算JSON对象或数组中元素的数量。")])])])]),t._v(" "),a("h1",{attrs:{id:"案例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#案例"}},[t._v("#")]),t._v(" 案例")]),t._v(" "),a("h2",{attrs:{id:"json-array-contains函数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#json-array-contains函数"}},[t._v("#")]),t._v(" json_array_contains函数")]),t._v(" "),a("p",[t._v("json_array_contains函数用于判断JSON数组中是否包含某个值。")]),t._v(" "),a("div",{staticClass:"language-unknow extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("json_array_contains(x, value)\n")])])]),a("table",[a("thead",[a("tr",[a("th",[t._v("参数")]),t._v(" "),a("th",[t._v("说明")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[a("em",[t._v("x")])]),t._v(" "),a("td",[t._v("参数值为JSON数组。")])]),t._v(" "),a("tr",[a("td",[a("em",[t._v("value")])]),t._v(" "),a("td",[t._v("数值。")])])])]),t._v(" "),a("p",[t._v("boolean类型。")]),t._v(" "),a("p",[t._v("判断JSON字符串[1, 2, 3]中是否包含2。")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("查询和分析语句")]),t._v(" "),a("div",{staticClass:"language-unknow extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("* | SELECT json_array_contains('[1, 2, 3]', 2)\n")])])])]),t._v(" "),a("li",[a("p",[t._v("查询和分析结果")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/8049136261/p294959.png",alt:"json_array_contains"}})])])]),t._v(" "),a("h2",{attrs:{id:"json-array-get函数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#json-array-get函数"}},[t._v("#")]),t._v(" json_array_get函数")]),t._v(" "),a("p",[t._v("json_array_get函数用于获取JSON数组下标对应的元素。")]),t._v(" "),a("div",{staticClass:"language-unknow extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("json_array_get(x, index)\n")])])]),a("table",[a("thead",[a("tr",[a("th",[t._v("参数")]),t._v(" "),a("th",[t._v("说明")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[a("em",[t._v("x")])]),t._v(" "),a("td",[t._v("参数值为JSON数组。")])]),t._v(" "),a("tr",[a("td",[a("em",[t._v("index")])]),t._v(" "),a("td",[t._v("JSON下标，从0开始。")])])])]),t._v(" "),a("p",[t._v("varchar类型。")]),t._v(" "),a("p",[t._v('返回JSON数组["a", [3, 9], "c"]下标为1的元素。')]),t._v(" "),a("ul",[a("li",[a("p",[t._v("查询和分析语句")]),t._v(" "),a("div",{staticClass:"language-unknow extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('* | SELECT json_array_get(\'["a", [3, 9], "c"]\', 1)\n')])])])]),t._v(" "),a("li",[a("p",[t._v("查询和分析结果")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/9311336261/p294990.png",alt:"json_array_get"}})])])]),t._v(" "),a("h2",{attrs:{id:"json-array-length函数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#json-array-length函数"}},[t._v("#")]),t._v(" json_array_length函数")]),t._v(" "),a("p",[t._v("json_array_length函数用于计算JSON数组中元素的数量。")]),t._v(" "),a("div",{staticClass:"language-unknow extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("json_array_length(x)\n")])])]),a("table",[a("thead",[a("tr",[a("th",[t._v("参数")]),t._v(" "),a("th",[t._v("说明")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[a("em",[t._v("x")])]),t._v(" "),a("td",[t._v("参数值为JSON数组。")])])])]),t._v(" "),a("p",[t._v("bigint类型。")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("示例1：计算Results字段值中JSON元素的数量。")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("字段样例")]),t._v(" "),a("div",{staticClass:"language-unknow extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('Results:[{"EndTime":1626314920},{"FireResult":2}]\n')])])])]),t._v(" "),a("li",[a("p",[t._v("查询和分析语句")]),t._v(" "),a("div",{staticClass:"language-unknow extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("* | SELECT json_array_length(Results)\n")])])])]),t._v(" "),a("li",[a("p",[t._v("查询和分析结果")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/8636136261/p294953.png",alt:"json_array_length"}})])])])]),t._v(" "),a("li",[a("p",[t._v("示例2：计算time字段值中JSON元素的数量。")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("字段样例")]),t._v(" "),a("div",{staticClass:"language-unknow extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('time:["time_local","request_time","upstream_response_time"]\n')])])])]),t._v(" "),a("li",[a("p",[t._v("查询和分析语句")]),t._v(" "),a("div",{staticClass:"language-unknow extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("* | SELECT json_array_length(time)\n")])])])]),t._v(" "),a("li",[a("p",[t._v("查询和分析结果")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/9636136261/p294955.png",alt:"json_array_length"}})])])])])]),t._v(" "),a("h2",{attrs:{id:"json-extract函数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#json-extract函数"}},[t._v("#")]),t._v(" json_extract函数")]),t._v(" "),a("p",[t._v("json_extract函数用于从JSON对象或JSON数组中提取一组JSON值（数组或对象）。\n"),a("strong",[t._v("注意")]),t._v(" 针对非法的JSON类型，json_extract函数会报错，建议您使用json_extract_scalar函数。")]),t._v(" "),a("div",{staticClass:"language-unknow extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("json_extract(x, json_path)\n")])])]),a("table",[a("thead",[a("tr",[a("th",[t._v("参数")]),t._v(" "),a("th",[t._v("说明")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[a("em",[t._v("x")])]),t._v(" "),a("td",[t._v("参数值为JSON对象或JSON数组。")])]),t._v(" "),a("tr",[a("td",[a("em",[t._v("json_path")])]),t._v(" "),a("td",[t._v("JSON路径，格式为$.store.book[0].title。")])])])]),t._v(" "),a("p",[t._v("JSON格式的string类型。")]),t._v(" "),a("p",[t._v("获取Results字段中EndTime字段的值。")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("字段样例")]),t._v(" "),a("div",{staticClass:"language-unknow extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('Results:[{"EndTime":1626314920},{"FireResult":2}]\n')])])])]),t._v(" "),a("li",[a("p",[t._v("查询和分析语句")]),t._v(" "),a("div",{staticClass:"language-unknow extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("* | SELECT json_extract(Results, '$.0.EndTime')\n")])])])]),t._v(" "),a("li",[a("p",[t._v("查询和分析结果")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/9311336261/p295024.png",alt:"json_extract"}})])])]),t._v(" "),a("h2",{attrs:{id:"json-extract-scalar函数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#json-extract-scalar函数"}},[t._v("#")]),t._v(" json_extract_scalar函数")]),t._v(" "),a("p",[t._v("json_extract_scalar函数用于从JSON对象或JSON数组中提取一组标量值（字符串、整数或布尔值）。")]),t._v(" "),a("div",{staticClass:"language-unknow extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("json_extract_scalar(x, json_path)\n")])])]),a("table",[a("thead",[a("tr",[a("th",[t._v("参数")]),t._v(" "),a("th",[t._v("说明")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[a("em",[t._v("x")])]),t._v(" "),a("td",[t._v("参数值为JSON对象或JSON数组。")])]),t._v(" "),a("tr",[a("td",[a("em",[t._v("json_path")])]),t._v(" "),a("td",[t._v("JSON路径，格式为$.store.book[0].title。")])])])]),t._v(" "),a("p",[t._v("varchar类型。")]),t._v(" "),a("p",[t._v("从Results字段中获取RawResultCount字段的值，并将该值转换为bigint类型进行求和。")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("字段样例")]),t._v(" "),a("div",{staticClass:"language-unknow extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('Results:[{"EndTime":1626314920},{"RawResultCount":1}]\n')])])])]),t._v(" "),a("li",[a("p",[t._v("查询和分析语句")]),t._v(" "),a("div",{staticClass:"language-unknow extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("* | SELECT sum(cast(json_extract_scalar(Results,'$.0.RawResultCount') AS bigint) )\n")])])])]),t._v(" "),a("li",[a("p",[t._v("查询和分析结果")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/9311336261/p295030.png",alt:"json_extract_scalar"}})])])]),t._v(" "),a("h2",{attrs:{id:"json-format函数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#json-format函数"}},[t._v("#")]),t._v(" json_format函数")]),t._v(" "),a("p",[t._v("json_format函数用于将JSON类型转化成字符串类型。")]),t._v(" "),a("div",{staticClass:"language-unknow extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("json_format(x)\n")])])]),a("table",[a("thead",[a("tr",[a("th",[t._v("参数")]),t._v(" "),a("th",[t._v("说明")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[a("em",[t._v("x")])]),t._v(" "),a("td",[t._v("参数值为JSON类型。")])])])]),t._v(" "),a("p",[t._v("varchar类型。")]),t._v(" "),a("p",[t._v("将JSON数组[1,2,3]转换为字符串[1, 2, 3]。")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("查询和分析语句")]),t._v(" "),a("div",{staticClass:"language-unknow extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("* | SELECT json_format(json_parse('[1, 2, 3]'))\n")])])])]),t._v(" "),a("li",[a("p",[t._v("查询和分析结果")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/0821046261/p294962.png",alt:"json_format"}})])])]),t._v(" "),a("h2",{attrs:{id:"json-parse函数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#json-parse函数"}},[t._v("#")]),t._v(" json_parse函数")]),t._v(" "),a("p",[t._v("json_parse函数只用于将字符串类型转化成JSON类型，判断是否符合JSON格式。一般情况下，json_parse函数使用意义不大，如果您需要从JSON中提取值，建议使用json_extract_scalar函数。")]),t._v(" "),a("div",{staticClass:"language-unknow extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("json_parse(x)\n")])])]),a("table",[a("thead",[a("tr",[a("th",[t._v("参数")]),t._v(" "),a("th",[t._v("说明")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[a("em",[t._v("x")])]),t._v(" "),a("td",[t._v("参数值为字符串。")])])])]),t._v(" "),a("p",[t._v("JSON类型。")]),t._v(" "),a("p",[t._v("将字符串[1,2,3]转换为JSON数组[1, 2, 3]。")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("查询和分析语句")]),t._v(" "),a("div",{staticClass:"language-unknow extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v(" * | SELECT json_parse('[1, 2, 3]')\n")])])])]),t._v(" "),a("li",[a("p",[t._v("查询和分析结果")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/0821046261/p294962.png",alt:"json_format"}})])])]),t._v(" "),a("h2",{attrs:{id:"json-size函数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#json-size函数"}},[t._v("#")]),t._v(" json_size函数")]),t._v(" "),a("p",[t._v("json_size函数用于计算JSON对象或JSON数组中元素的数量。")]),t._v(" "),a("div",{staticClass:"language-unknow extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("json_size(x, json_path)\n")])])]),a("table",[a("thead",[a("tr",[a("th",[t._v("参数")]),t._v(" "),a("th",[t._v("说明")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[a("em",[t._v("x")])]),t._v(" "),a("td",[t._v("参数值为JSON对象或JSON数组。")])]),t._v(" "),a("tr",[a("td",[a("em",[t._v("json_path")])]),t._v(" "),a("td",[t._v("JSON路径，格式为$.store.book[0].title。")])])])]),t._v(" "),a("p",[t._v("bigint类型。")]),t._v(" "),a("p",[t._v("返回status字段中元素的数量。")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("字段样例")]),t._v(" "),a("div",{staticClass:"language-unknow extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('Results:[{"EndTime":1626314920,"FireResult":2,"RawResults":[{"_col0":"1094"}]}]\n')])])])]),t._v(" "),a("li",[a("p",[t._v("查询和分析语句")]),t._v(" "),a("div",{staticClass:"language-unknow extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("* | SELECT json_size(Results, '$.0.RawResults')\n")])])])]),t._v(" "),a("li",[a("p",[t._v("查询和分析结果")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/9311336261/p295005.png",alt:"json_size"}})])])])])}),[],!1,null,null,null);a.default=e.exports}}]);